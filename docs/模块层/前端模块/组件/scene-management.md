# åœºæ™¯ç®¡ç†åŠŸèƒ½è¯¦ç»†æ–‡æ¡£

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

åœºæ™¯ç®¡ç†ç³»ç»Ÿæ˜¯MCP Feedback Collectorçš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ï¼Œæä¾›äº†å®Œæ•´çš„å·¥ä½œåœºæ™¯åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤å’Œç®¡ç†èƒ½åŠ›ã€‚ç³»ç»Ÿæ”¯æŒåœºæ™¯åŒ–çš„AIåä½œä½“éªŒï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®ä¸åŒçš„å·¥ä½œéœ€æ±‚åˆ›å»ºè‡ªå®šä¹‰åœºæ™¯ï¼Œæ¯ä¸ªåœºæ™¯å¯ä»¥é…ç½®å¤šç§å·¥ä½œæ¨¡å¼ï¼Œå®ç°ä¸ªæ€§åŒ–çš„æç¤ºè¯ç®¡ç†å’Œå·¥ä½œæµç¨‹ã€‚

## ğŸ­ æ ¸å¿ƒç‰¹æ€§

### åœºæ™¯ç®¡ç†
- **åˆ›å»ºåœºæ™¯**: æ”¯æŒåˆ›å»ºè‡ªå®šä¹‰å·¥ä½œåœºæ™¯ï¼ŒåŒ…å«åç§°ã€æè¿°ã€å›¾æ ‡ã€é»˜è®¤è®¾ç½®ç­‰ä¿¡æ¯
- **ç¼–è¾‘åœºæ™¯**: å®æ—¶ç¼–è¾‘åœºæ™¯é…ç½®ï¼Œæ”¯æŒä¿®æ”¹åŸºæœ¬ä¿¡æ¯å’Œè®¾ç½®
- **åˆ é™¤åœºæ™¯**: å®‰å…¨åˆ é™¤åœºæ™¯ï¼ŒåŒ…å«ç¡®è®¤æœºåˆ¶å’Œä¾èµ–æ£€æŸ¥ï¼ˆé»˜è®¤åœºæ™¯ä¸å¯åˆ é™¤ï¼‰
- **åœºæ™¯å¤åˆ¶**: å¿«é€Ÿå¤åˆ¶ç°æœ‰åœºæ™¯ï¼Œä¾¿äºåˆ›å»ºç›¸ä¼¼é…ç½®
- **é»˜è®¤åœºæ™¯**: å†…ç½®ç¼–ç åœºæ™¯ï¼ŒåŒ…å«æ¢è®¨ã€ç¼–è¾‘ã€æœç´¢ä¸‰ç§æ ¸å¿ƒæ¨¡å¼
- **åœºæ™¯æ’åº**: æ”¯æŒåœºæ™¯çš„æ’åºç®¡ç†ï¼Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒ

### æ¨¡å¼ç®¡ç†
- **æ¨¡å¼é…ç½®**: æ¯ä¸ªåœºæ™¯å¯é…ç½®å¤šç§å·¥ä½œæ¨¡å¼ï¼ˆæ¢è®¨ã€ç¼–è¾‘ã€æœç´¢ç­‰ï¼‰
- **æ¨¡å¼åˆ‡æ¢**: å®æ—¶åˆ‡æ¢å·¥ä½œæ¨¡å¼ï¼Œæ— éœ€é‡å¯æœåŠ¡
- **é»˜è®¤æ¨¡å¼**: æ”¯æŒè®¾ç½®åœºæ™¯çš„é»˜è®¤å·¥ä½œæ¨¡å¼
- **å¿«æ·é”®ç®¡ç†**: æ”¯æŒæ•°å­—é”®å¿«é€Ÿåˆ‡æ¢æ¨¡å¼ï¼ˆ1-9ï¼‰ï¼Œè‡ªåŠ¨åˆ†é…å’Œå†²çªå¤„ç†
- **æ¨¡å¼æ’åº**: æ”¯æŒæ¨¡å¼çš„æ’åºç®¡ç†ï¼ŒæŒ‰å¿«æ·é”®æˆ–è‡ªå®šä¹‰é¡ºåºæ’åˆ—

### æç¤ºè¯ç®¡ç†
- **æ¨¡æ¿åŒ–æç¤ºè¯**: æ”¯æŒå˜é‡æ›¿æ¢å’Œæ¨¡æ¿æ¸²æŸ“ï¼ˆå¦‚`{{ feedback }}`ï¼‰
- **åœºæ™¯åŒ–æç¤ºè¯**: ä¸åŒåœºæ™¯ä½¿ç”¨ä¸åŒçš„æç¤ºè¯æ¨¡æ¿
- **åŠ¨æ€åŠ è½½**: æ”¯æŒè¿è¡Œæ—¶åŠ¨æ€åŠ è½½å’Œæ›´æ–°æç¤ºè¯
- **ç¼“å­˜æœºåˆ¶**: å®ç°SQLite+localStorageåŒé‡ç¼“å­˜ç­–ç•¥ï¼Œæå‡æ€§èƒ½

### é…ç½®å¯¼å…¥å¯¼å‡º
- **é…ç½®å¯¼å‡º**: æ”¯æŒå¯¼å‡ºåœºæ™¯é…ç½®ä¸ºJSONæ–‡ä»¶ï¼ŒåŒ…å«åœºæ™¯ã€æ¨¡å¼ã€æç¤ºè¯
- **é…ç½®å¯¼å…¥**: æ”¯æŒä»JSONæ–‡ä»¶æ‰¹é‡å¯¼å…¥åœºæ™¯é…ç½®
- **é…ç½®é¢„è§ˆ**: å¯¼å…¥å‰æ”¯æŒé¢„è§ˆé…ç½®å†…å®¹å’Œç»Ÿè®¡ä¿¡æ¯
- **ç‰ˆæœ¬æ§åˆ¶**: å¯¼å‡ºæ–‡ä»¶åŒ…å«ç‰ˆæœ¬ä¿¡æ¯å’Œæ—¶é—´æˆ³

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### ç»„ä»¶æ¶æ„

```mermaid
graph TB
    subgraph "åœºæ™¯ç®¡ç†ç»„ä»¶"
        A[SceneManagement.vue] --> B[åœºæ™¯åˆ—è¡¨ç½‘æ ¼]
        A --> C[åœºæ™¯è¯¦æƒ…ä¾§è¾¹æ ]
        A --> D[æ¨¡å¼ç®¡ç†å™¨]
        A --> E[åˆ›å»º/ç¼–è¾‘å¯¹è¯æ¡†]
        A --> F[å¯¼å…¥å¯¼å‡ºåŠŸèƒ½]
    end
    
    subgraph "çŠ¶æ€ç®¡ç†"
        G[scenes.ts Store] --> H[åœºæ™¯æ•°æ®ç®¡ç†]
        G --> I[æ¨¡å¼æ•°æ®ç®¡ç†]
        G --> J[å½“å‰é€‰æ‹©çŠ¶æ€]
        G --> K[æ“ä½œçŠ¶æ€ç®¡ç†]
    end
    
    subgraph "æœåŠ¡å±‚"
        L[promptService.ts] --> M[åœºæ™¯APIæ¥å£]
        L --> N[æ¨¡å¼APIæ¥å£]
        L --> O[æç¤ºè¯APIæ¥å£]
        L --> P[é…ç½®å¯¼å…¥å¯¼å‡º]
    end
    
    subgraph "åç«¯æ”¯æŒ"
        Q[prompt-database.ts] --> R[SQLiteæ•°æ®åº“]
        S[default-scenes.ts] --> T[é»˜è®¤é…ç½®]
        U[web-server.ts] --> V[RESTful API]
    end
    
    A --> G
    G --> L
    L --> V
    V --> Q
    T --> Q
```

### æ•°æ®æµæ¶æ„

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant C as SceneManagementç»„ä»¶
    participant S as scenes Store
    participant P as promptService
    participant A as Web API
    participant D as SQLiteæ•°æ®åº“
    
    U->>C: åˆ›å»ºåœºæ™¯
    C->>S: createScene(sceneData)
    S->>P: createScene(sceneData)
    P->>A: POST /api/scenes
    A->>D: INSERTåœºæ™¯æ•°æ®
    D-->>A: è¿”å›æ–°åœºæ™¯
    A-->>P: è¿”å›åœºæ™¯å¯¹è±¡
    P-->>S: è¿”å›åœºæ™¯å¯¹è±¡
    S-->>C: æ›´æ–°åœºæ™¯åˆ—è¡¨
    C-->>U: æ˜¾ç¤ºæ–°åœºæ™¯
```

## ğŸ“ æ–‡ä»¶ç»“æ„ä¸ä»£ç åˆ†æ

### å‰ç«¯ç»„ä»¶
- **`frontend/src/components/SceneManagement.vue`** (1751è¡Œ)
  - åœºæ™¯ç®¡ç†çš„ä¸»è¦UIç»„ä»¶
  - åŒ…å«åœºæ™¯ç½‘æ ¼åˆ—è¡¨ã€è¯¦æƒ…ä¾§è¾¹æ ã€æ¨¡å¼ç®¡ç†ç­‰åŠŸèƒ½
  - æ”¯æŒåˆ›å»º/ç¼–è¾‘å¯¹è¯æ¡†ã€å¯¼å…¥å¯¼å‡ºåŠŸèƒ½
  - å®ç°å“åº”å¼è®¾è®¡å’Œæ·±è‰²ä¸»é¢˜

### çŠ¶æ€ç®¡ç†
- **`frontend/src/stores/scenes.ts`** (495è¡Œ)
  - åœºæ™¯æ•°æ®çš„PiniaçŠ¶æ€ç®¡ç†
  - æä¾›åœºæ™¯å’Œæ¨¡å¼çš„å®Œæ•´CRUDæ“ä½œ
  - åŒ…å«å½“å‰é€‰æ‹©çŠ¶æ€å’Œæ“ä½œçŠ¶æ€ç®¡ç†
  - å®ç°å¿«æ·é”®å†²çªå¤„ç†å’Œæ¨¡å¼æ’åº

### æœåŠ¡å±‚
- **`frontend/src/services/promptService.ts`** (626è¡Œ)
  - åœºæ™¯ç®¡ç†ç›¸å…³çš„APIå°è£…
  - æä¾›ä¸åç«¯é€šä¿¡çš„å®Œæ•´æ¥å£
  - å®ç°SQLite+localStorageåŒé‡ç¼“å­˜ç­–ç•¥
  - åŒ…å«åœºæ™¯ã€æ¨¡å¼ã€æç¤ºè¯çš„æ“ä½œæ–¹æ³•

### ç±»å‹å®šä¹‰
- **`frontend/src/types/app.ts`** (146è¡Œ)
  - å®Œæ•´çš„TypeScriptç±»å‹å®šä¹‰
  - åŒ…å«Sceneã€SceneModeã€CurrentSelectionç­‰æ ¸å¿ƒç±»å‹
  - å®šä¹‰APIè¯·æ±‚å’Œå“åº”çš„æ•°æ®ç»“æ„
  - æ”¯æŒé…ç½®å¯¼å…¥å¯¼å‡ºçš„æ•°æ®æ ¼å¼

### åç«¯æ”¯æŒ
- **`src/utils/prompt-database.ts`** (942è¡Œ)
  - SQLiteæ•°æ®åº“æ“ä½œå’Œæ•°æ®æ¨¡å‹å®šä¹‰
  - åœºæ™¯å’Œæ¨¡å¼æ•°æ®çš„æŒä¹…åŒ–å­˜å‚¨
  - æ•°æ®åº“ç‰ˆæœ¬ç®¡ç†å’Œè¿ç§»æ”¯æŒ
  - æä¾›å®Œæ•´çš„æ•°æ®åº“CRUDæ“ä½œ

- **`src/utils/default-scenes.ts`** (435è¡Œ)
  - é»˜è®¤åœºæ™¯é…ç½®å®šä¹‰
  - å†…ç½®ç¼–ç åœºæ™¯å’Œä¸‰ç§å·¥ä½œæ¨¡å¼
  - æä¾›åœºæ™¯åˆå§‹åŒ–æ•°æ®å’Œé…ç½®ç»“æ„

- **`src/server/web-server.ts`** (1722è¡Œ)
  - RESTful APIç«¯ç‚¹å®ç°
  - åœºæ™¯ç®¡ç†ç›¸å…³çš„HTTPæ¥å£
  - Socket.IOå®æ—¶é€šä¿¡æ”¯æŒ
  - ä¼šè¯ç®¡ç†å’Œé”™è¯¯å¤„ç†

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½å®ç°

### 1. åœºæ™¯åˆ›å»ºä¸ç®¡ç†

```typescript
// scenes.ts Store - åœºæ™¯åˆ›å»º
const createScene = async (sceneData: SceneRequest): Promise<Scene> => {
  saving.value = true
  
  try {
    const newScene = await promptService.createScene(sceneData)
    scenes.value.push(newScene)
    return newScene
  } catch (err) {
    const errorMessage = err instanceof Error ? err.message : 'åˆ›å»ºåœºæ™¯å¤±è´¥'
    error.value = errorMessage
    throw err
  } finally {
    saving.value = false
  }
}

// åœºæ™¯æ›´æ–°
const updateScene = async (sceneId: string, sceneData: Partial<SceneRequest>): Promise<Scene> => {
  saving.value = true
  
  try {
    const updatedScene = await promptService.updateScene(sceneId, sceneData)
    const index = scenes.value.findIndex(s => s.id === sceneId)
    if (index !== -1) {
      scenes.value[index] = updatedScene
    }
    return updatedScene
  } catch (err) {
    const errorMessage = err instanceof Error ? err.message : 'æ›´æ–°åœºæ™¯å¤±è´¥'
    error.value = errorMessage
    throw err
  } finally {
    saving.value = false
  }
}
```

### 2. æ¨¡å¼ç®¡ç†ä¸å¿«æ·é”®å¤„ç†

```typescript
// æ·»åŠ åœºæ™¯æ¨¡å¼ï¼ŒåŒ…å«å¿«æ·é”®å†²çªå¤„ç†
const addSceneMode = async (sceneId: string, modeData: SceneModeRequest): Promise<SceneMode> => {
  saving.value = true
  
  try {
    // å¦‚æœè®¾ç½®äº†å¿«æ·é”®ï¼Œæ£€æŸ¥å†²çªå¹¶å¤„ç†
    if (modeData.shortcut && /^\d$/.test(modeData.shortcut)) {
      await handleShortcutConflict(sceneId, modeData.shortcut, null)
    }
    
    const newMode = await promptService.addSceneMode(sceneId, modeData)
    
    // æ›´æ–°å½“å‰åœºæ™¯æ¨¡å¼åˆ—è¡¨
    if (currentSelection.value.sceneId === sceneId) {
      currentSceneModes.value.push(newMode)
      currentSceneModes.value = sortSceneModes(currentSceneModes.value)
    }
    
    return newMode
  } catch (err) {
    const errorMessage = err instanceof Error ? err.message : 'æ·»åŠ æ¨¡å¼å¤±è´¥'
    error.value = errorMessage
    throw err
  } finally {
    saving.value = false
  }
}

// å¿«æ·é”®å†²çªå¤„ç†
const handleShortcutConflict = async (sceneId: string, shortcut: string, excludeModeId: string | null): Promise<void> => {
  try {
    const conflictMode = currentSceneModes.value.find(mode => 
      mode.shortcut === shortcut && mode.id !== excludeModeId
    )
    
    if (conflictMode) {
      // æ¸…é™¤å†²çªæ¨¡å¼çš„å¿«æ·é”®
      await promptService.updateSceneMode(sceneId, conflictMode.id, { shortcut: undefined })
      
      // æ›´æ–°æœ¬åœ°çŠ¶æ€
      const index = currentSceneModes.value.findIndex(m => m.id === conflictMode.id)
      if (index !== -1) {
        currentSceneModes.value[index].shortcut = undefined
      }
    }
  } catch (err) {
    console.error('[ScenesStore] å¤„ç†å¿«æ·é”®å†²çªå¤±è´¥:', err)
  }
}
```

### 3. æç¤ºè¯æ¨¡æ¿æ¸²æŸ“

```typescript
// æç¤ºè¯æ¨¡æ¿ç¤ºä¾‹ï¼ˆæ¥è‡ªdefault-scenes.tsï¼‰
const promptTemplate = `# ç”¨æˆ·åé¦ˆ
{{ feedback }}

æ³¨æ„: ä»¥ä¸‹è¦æ±‚,ä»…åœ¨æœ¬æ¬¡åé¦ˆä¹‹åæœ‰æ•ˆ,ä¹‹åè¯·å¦éµå¾ªç”¨æˆ·æŒ‡ä»¤
---
<task>

# ä»»åŠ¡
æ¥ä¸‹æ¥ä½ çš„ä»»åŠ¡æ˜¯æ ¹æ®ç”¨æˆ·æä¾›çš„åé¦ˆ, æ¢è®¨å¹¶ç»™å‡ºå…·ä½“çš„å®æ–½æ„è§

# å…·ä½“ç»†åˆ™
- ç»™å‡ºçš„æ„è§å¿…é¡»ç»è¿‡å…¨å±€è€ƒè™‘
- å¦‚æœä½ æ²¡æœ‰æ·±å…¥ç†è§£ä»£ç ,è¯·å…ˆæŸ¥çœ‹ä»£ç é€»è¾‘
- å¯¹äºæ–¹æ³•çš„é‡æ„,å¿…é¡»ç»™å‡ºå®Œå–„çš„é‡æ„æ–¹æ¡ˆ(è€ƒè™‘å¯¹ç°æœ‰ä»£ç çš„å½±å“)
- å¦‚é‡åˆ°é—®é¢˜,è¯·ç¬¬ä¸€æ—¶é—´å‘ç”¨æˆ·åé¦ˆ
- è¯¥é˜¶æ®µç¦æ­¢ä½¿ç”¨å·¥å…·è¿›è¡Œ\`making_code_changes\`
...`

// æ¨¡æ¿å˜é‡æ›¿æ¢ï¼ˆåœ¨promptServiceä¸­å®ç°ï¼‰
const renderPrompt = (template: string, variables: Record<string, string>): string => {
  return template.replace(/\{\{\s*(\w+)\s*\}\}/g, (match, key) => {
    return variables[key] || match
  })
}
```

### 4. é…ç½®å¯¼å…¥å¯¼å‡º

```typescript
// å¯¼å‡ºåœºæ™¯é…ç½®
const exportSceneConfig = async (): Promise<SceneConfigExport> => {
  try {
    const response = await fetch(`${this.SCENES_API_BASE}/export`)
    
    if (!response.ok) {
      await this.handleApiError(response)
    }

    const result: SceneConfigExportResponse = await response.json()
    return result.config
  } catch (error) {
    throw error
  }
}

// å¯¼å…¥åœºæ™¯é…ç½®
const importSceneConfig = async (config: SceneConfigExport): Promise<void> => {
  try {
    const response = await fetch(`${this.SCENES_API_BASE}/import`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(config),
    })

    if (!response.ok) {
      await this.handleApiError(response)
    }

    const result: ApiResponse = await response.json()
    
    if (!result.success) {
      throw new Error(result.error || result.message || 'å¯¼å…¥é…ç½®å¤±è´¥')
    }

    // æ¸…ç†æ‰€æœ‰ç¼“å­˜
    this.clearAllSceneCache()
  } catch (error) {
    throw error
  }
}
```

## ğŸ¨ ç”¨æˆ·ç•Œé¢è®¾è®¡

### åœºæ™¯ç½‘æ ¼è§†å›¾
- **å“åº”å¼ç½‘æ ¼å¸ƒå±€**: ä½¿ç”¨CSS Gridå®ç°è‡ªé€‚åº”å¸ƒå±€
- **åœºæ™¯å¡ç‰‡è®¾è®¡**: åŒ…å«åœºæ™¯åç§°ã€æè¿°ã€æ¨¡å¼æ•°é‡ã€åˆ›å»ºæ—¶é—´ç­‰ä¿¡æ¯
- **çŠ¶æ€æŒ‡ç¤ºå™¨**: é»˜è®¤åœºæ™¯æ ‡è¯†ã€å½“å‰é€‰æ‹©çŠ¶æ€ã€æ“ä½œçŠ¶æ€ç­‰
- **äº¤äº’æ“ä½œ**: ç¼–è¾‘ã€å¤åˆ¶ã€åˆ é™¤ç­‰æ“ä½œæŒ‰é’®ï¼Œæ”¯æŒé”®ç›˜å¿«æ·é”®

### åœºæ™¯è¯¦æƒ…ä¾§è¾¹æ 
- **æ»‘åŠ¨å¼ä¾§è¾¹æ **: ç‚¹å‡»åœºæ™¯å¡ç‰‡æ—¶ä»å³ä¾§æ»‘å‡º
- **åŸºæœ¬ä¿¡æ¯å±•ç¤º**: åœºæ™¯åç§°ã€æè¿°ã€åˆ›å»ºæ—¶é—´ã€æ›´æ–°æ—¶é—´ç­‰
- **æ¨¡å¼ç®¡ç†ç•Œé¢**: æ¨¡å¼åˆ—è¡¨ã€æ·»åŠ æ¨¡å¼ã€ç¼–è¾‘æ¨¡å¼ç­‰åŠŸèƒ½
- **æ“ä½œæŒ‰é’®**: ç¼–è¾‘åœºæ™¯ã€æ·»åŠ æ¨¡å¼ã€ç¼–è¾‘æç¤ºè¯ç­‰

### åˆ›å»º/ç¼–è¾‘å¯¹è¯æ¡†
- **æ¨¡æ€å¯¹è¯æ¡†è®¾è®¡**: å±…ä¸­æ˜¾ç¤ºï¼Œæ”¯æŒé”®ç›˜æ“ä½œ
- **è¡¨å•éªŒè¯**: å®æ—¶éªŒè¯ç”¨æˆ·è¾“å…¥ï¼Œæä¾›é”™è¯¯æç¤º
- **å¿«æ·é”®è‡ªåŠ¨åˆ†é…**: è‡ªåŠ¨ä¸ºæ–°æ¨¡å¼åˆ†é…å¯ç”¨çš„æ•°å­—å¿«æ·é”®
- **å¼€å…³æ§ä»¶**: ä½¿ç”¨ç°ä»£åŒ–çš„å¼€å…³æ§ä»¶è®¾ç½®é»˜è®¤çŠ¶æ€

### å¯¼å…¥å¯¼å‡ºåŠŸèƒ½
- **æ–‡ä»¶é€‰æ‹©å™¨**: æ”¯æŒJSONæ–‡ä»¶çš„é€‰æ‹©å’ŒéªŒè¯
- **å¯¼å…¥é¢„è§ˆ**: æ˜¾ç¤ºå¯¼å…¥æ–‡ä»¶çš„ç»Ÿè®¡ä¿¡æ¯å’Œå†…å®¹é¢„è§ˆ
- **è¿›åº¦æŒ‡ç¤º**: å¯¼å…¥å¯¼å‡ºè¿‡ç¨‹çš„è¿›åº¦æç¤ºå’ŒçŠ¶æ€åé¦ˆ

## ğŸ“Š æ•°æ®æ¨¡å‹

### Scene åœºæ™¯æ¨¡å‹
```typescript
interface Scene {
  id: string              // åœºæ™¯å”¯ä¸€æ ‡è¯†
  name: string           // åœºæ™¯åç§°
  description: string    // åœºæ™¯æè¿°
  icon?: string         // åœºæ™¯å›¾æ ‡ï¼ˆå¯é€‰ï¼‰
  isDefault: boolean    // æ˜¯å¦ä¸ºé»˜è®¤åœºæ™¯
  sortOrder: number     // æ’åºé¡ºåº
  createdAt: number     // åˆ›å»ºæ—¶é—´ï¼ˆæ—¶é—´æˆ³ï¼‰
  updatedAt: number     // æ›´æ–°æ—¶é—´ï¼ˆæ—¶é—´æˆ³ï¼‰
}
```

### SceneMode åœºæ™¯æ¨¡å¼æ¨¡å‹
```typescript
interface SceneMode {
  id: string              // æ¨¡å¼å”¯ä¸€æ ‡è¯†
  sceneId: string        // æ‰€å±åœºæ™¯ID
  name: string           // æ¨¡å¼åç§°
  description: string    // æ¨¡å¼æè¿°
  shortcut?: string      // å¿«æ·é”®ï¼ˆ1-9æ•°å­—ï¼‰
  isDefault: boolean     // æ˜¯å¦ä¸ºé»˜è®¤æ¨¡å¼
  sortOrder: number      // æ’åºé¡ºåº
  createdAt: number      // åˆ›å»ºæ—¶é—´ï¼ˆæ—¶é—´æˆ³ï¼‰
  updatedAt: number      // æ›´æ–°æ—¶é—´ï¼ˆæ—¶é—´æˆ³ï¼‰
}
```

### CurrentSelection å½“å‰é€‰æ‹©çŠ¶æ€
```typescript
interface CurrentSelection {
  sceneId: string        // å½“å‰åœºæ™¯ID
  modeId: string         // å½“å‰æ¨¡å¼ID
}
```

### SceneConfigExport é…ç½®å¯¼å‡ºæ ¼å¼
```typescript
interface SceneConfigExport {
  version: string        // é…ç½®ç‰ˆæœ¬
  exportedAt: number     // å¯¼å‡ºæ—¶é—´æˆ³
  scenes: Scene[]        // åœºæ™¯åˆ—è¡¨
  modes: SceneMode[]     // æ¨¡å¼åˆ—è¡¨
  prompts: Array<{       // æç¤ºè¯åˆ—è¡¨
    sceneId: string
    modeId: string
    prompt: string
  }>
}
```

## ğŸ”„ APIæ¥å£è®¾è®¡

### åœºæ™¯ç®¡ç†API
- **GET /api/scenes** - è·å–æ‰€æœ‰åœºæ™¯åˆ—è¡¨
- **GET /api/scenes/:sceneId** - è·å–åœºæ™¯è¯¦æƒ…ï¼ˆåŒ…å«æ¨¡å¼ï¼‰
- **POST /api/scenes** - åˆ›å»ºæ–°åœºæ™¯
- **PUT /api/scenes/:sceneId** - æ›´æ–°åœºæ™¯ä¿¡æ¯
- **DELETE /api/scenes/:sceneId** - åˆ é™¤åœºæ™¯

### æ¨¡å¼ç®¡ç†API
- **GET /api/scenes/:sceneId/modes** - è·å–åœºæ™¯ä¸‹çš„æ‰€æœ‰æ¨¡å¼
- **POST /api/scenes/:sceneId/modes** - ä¸ºåœºæ™¯æ·»åŠ æ–°æ¨¡å¼
- **PUT /api/scenes/:sceneId/modes/:modeId** - æ›´æ–°æ¨¡å¼ä¿¡æ¯
- **DELETE /api/scenes/:sceneId/modes/:modeId** - åˆ é™¤æ¨¡å¼

### æç¤ºè¯ç®¡ç†API
- **GET /api/unified/prompt** - è·å–ç»Ÿä¸€æç¤ºè¯ï¼ˆåŸºäºå½“å‰é€‰æ‹©ï¼‰
- **POST /api/unified/prompt** - ä¿å­˜ç»Ÿä¸€æç¤ºè¯

### é…ç½®ç®¡ç†API
- **GET /api/scenes/export** - å¯¼å‡ºåœºæ™¯é…ç½®
- **POST /api/scenes/import** - å¯¼å…¥åœºæ™¯é…ç½®

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•
- **Storeæ–¹æ³•æµ‹è¯•**: æµ‹è¯•scenes storeä¸­çš„æ‰€æœ‰æ–¹æ³•
- **æœåŠ¡å±‚æµ‹è¯•**: æµ‹è¯•promptServiceçš„APIè°ƒç”¨
- **ç»„ä»¶æ–¹æ³•æµ‹è¯•**: æµ‹è¯•SceneManagementç»„ä»¶çš„å…³é”®æ–¹æ³•

### é›†æˆæµ‹è¯•
- **åœºæ™¯CRUDæµ‹è¯•**: æµ‹è¯•åœºæ™¯çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸæ“ä½œ
- **æ¨¡å¼ç®¡ç†æµ‹è¯•**: æµ‹è¯•æ¨¡å¼çš„åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤æµç¨‹
- **å¿«æ·é”®å†²çªæµ‹è¯•**: æµ‹è¯•å¿«æ·é”®åˆ†é…å’Œå†²çªå¤„ç†æœºåˆ¶

### ç”¨æˆ·ä½“éªŒæµ‹è¯•
- **åœºæ™¯åˆ‡æ¢æ€§èƒ½**: æµ‹è¯•åœºæ™¯åˆ‡æ¢çš„å“åº”æ—¶é—´
- **å¤§æ•°æ®é‡æµ‹è¯•**: æµ‹è¯•å¤§é‡åœºæ™¯å’Œæ¨¡å¼çš„æ€§èƒ½è¡¨ç°
- **é”™è¯¯å¤„ç†æµ‹è¯•**: æµ‹è¯•å„ç§é”™è¯¯æƒ…å†µçš„ç”¨æˆ·åé¦ˆ

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### æ•°æ®åŠ è½½ä¼˜åŒ–
- **æ‡’åŠ è½½ç­–ç•¥**: æŒ‰éœ€åŠ è½½åœºæ™¯æ¨¡å¼æ•°æ®
- **ç¼“å­˜æœºåˆ¶**: SQLite+localStorageåŒé‡ç¼“å­˜
- **æ‰¹é‡æ“ä½œ**: æ”¯æŒæ‰¹é‡åˆ›å»ºå’Œæ›´æ–°æ“ä½œ

### ç•Œé¢æ¸²æŸ“ä¼˜åŒ–
- **è™šæ‹Ÿæ»šåŠ¨**: æ”¯æŒå¤§é‡åœºæ™¯çš„é«˜æ•ˆæ¸²æŸ“
- **é˜²æŠ–å¤„ç†**: ç”¨æˆ·è¾“å…¥çš„é˜²æŠ–å¤„ç†
- **ç»„ä»¶æ‡’åŠ è½½**: æŒ‰éœ€åŠ è½½å¯¹è¯æ¡†å’Œä¾§è¾¹æ ç»„ä»¶

### çŠ¶æ€ç®¡ç†ä¼˜åŒ–
- **å“åº”å¼æ›´æ–°**: ä½¿ç”¨Vue 3çš„å“åº”å¼ç³»ç»Ÿ
- **çŠ¶æ€æŒä¹…åŒ–**: å…³é”®çŠ¶æ€çš„æœ¬åœ°å­˜å‚¨
- **å†…å­˜ç®¡ç†**: åŠæ—¶æ¸…ç†ä¸éœ€è¦çš„çŠ¶æ€æ•°æ®

## ğŸ”§ é»˜è®¤åœºæ™¯é…ç½®

### å†…ç½®ç¼–ç åœºæ™¯
ç³»ç»Ÿå†…ç½®ä¸€ä¸ªé»˜è®¤çš„ç¼–ç åœºæ™¯ï¼ŒåŒ…å«ä¸‰ç§æ ¸å¿ƒå·¥ä½œæ¨¡å¼ï¼š

1. **æ¢è®¨æ¨¡å¼** (discuss) - å¿«æ·é”®: 1
   - **åŠŸèƒ½**: æ·±å…¥åˆ†æå’Œå»ºè®®ï¼Œæä¾›å…·ä½“çš„å®æ–½æ„è§
   - **ç‰¹ç‚¹**: ç¦æ­¢ç›´æ¥ä¿®æ”¹ä»£ç ï¼Œä¸“æ³¨äºåˆ†æå’Œå»ºè®®
   - **åº”ç”¨**: ä»£ç å®¡æŸ¥ã€æ¶æ„è®¨è®ºã€é—®é¢˜åˆ†æç­‰

2. **ç¼–è¾‘æ¨¡å¼** (edit) - å¿«æ·é”®: 2
   - **åŠŸèƒ½**: ä»£ç ä¿®æ”¹å’Œä¼˜åŒ–ï¼Œç¼–å†™å…·ä½“çš„ä»£ç å®ç°
   - **ç‰¹ç‚¹**: å…è®¸ç›´æ¥ä¿®æ”¹ä»£ç ï¼Œåˆ†æ­¥éª¤è¿›è¡Œå¼€å‘
   - **åº”ç”¨**: ä»£ç ç¼–å†™ã€åŠŸèƒ½å®ç°ã€bugä¿®å¤ç­‰

3. **æœç´¢æ¨¡å¼** (search) - å¿«æ·é”®: 3
   - **åŠŸèƒ½**: ä¿¡æ¯æŸ¥æ‰¾å’Œæ£€ç´¢ï¼Œæ·±åº¦æ£€ç´¢ç›¸å…³ä»£ç 
   - **ç‰¹ç‚¹**: æ”¯æŒä»£ç æœç´¢å’Œç½‘ç»œä¿¡æ¯æ£€ç´¢
   - **åº”ç”¨**: ä»£ç æŸ¥æ‰¾ã€æ–‡æ¡£æœç´¢ã€æŠ€æœ¯è°ƒç ”ç­‰

### è‡ªå®šä¹‰åœºæ™¯
ç”¨æˆ·å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰åœºæ™¯ï¼ŒåŒ…æ‹¬ï¼š
- **è‡ªå®šä¹‰åœºæ™¯åç§°å’Œæè¿°**: æ ¹æ®å·¥ä½œéœ€æ±‚å®šä¹‰åœºæ™¯
- **è‡ªå®šä¹‰å·¥ä½œæ¨¡å¼é…ç½®**: åˆ›å»ºç‰¹å®šçš„å·¥ä½œæ¨¡å¼
- **è‡ªå®šä¹‰æç¤ºè¯æ¨¡æ¿**: ç¼–å†™ä¸“é—¨çš„æç¤ºè¯æ¨¡æ¿
- **è‡ªå®šä¹‰å¿«æ·é”®è®¾ç½®**: è®¾ç½®ä¾¿äºè®°å¿†çš„å¿«æ·é”®

## ğŸ§­ å¯¼èˆªé“¾æ¥

- **ğŸ“‹ [è¿”å›ä¸»ç›®å½•](../../../README.md)** - è¿”å›æ–‡æ¡£å¯¼èˆªä¸­å¿ƒ
- **ğŸ”§ [è¿”å›å‰ç«¯ç»„ä»¶ç›®å½•](./index.md)** - è¿”å›å‰ç«¯ç»„ä»¶å¯¼èˆª
- **ğŸ“Š [åœºæ™¯çŠ¶æ€ç®¡ç†](../../çŠ¶æ€ç®¡ç†/index.md)** - æŸ¥çœ‹åœºæ™¯çŠ¶æ€ç®¡ç†æ–‡æ¡£
- **ğŸ”Œ [æç¤ºè¯æœåŠ¡](../../æœåŠ¡/index.md)** - æŸ¥çœ‹æç¤ºè¯æœåŠ¡æ–‡æ¡£

---

*åœºæ™¯ç®¡ç†åŠŸèƒ½æ–‡æ¡£æœ€åæ›´æ–°: 2024å¹´1æœˆ*
*æ–‡æ¡£ç‰ˆæœ¬: v2.0.0* 